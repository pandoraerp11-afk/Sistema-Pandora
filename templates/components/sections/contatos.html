{% comment %}
COMPONENTE: Seção de Contatos (Formset Dinâmico)
Reutilizável para: clientes, fornecedores, empresas, etc.

COMO USAR:
{% include "components/sections/contatos.html" with formset=contatos_formset title="Contatos" %}
{% endcomment %}

<div class="card mb-4">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="card-title mb-0">
            <i class="fas fa-users me-2"></i>
            {{ title|default:"Contatos" }}
        </h5>
        <button type="button" class="btn btn-sm btn-primary add-formset-row" 
                data-formset-prefix="{{ formset.prefix }}">
            <i class="fas fa-plus me-1"></i> Adicionar Contato
        </button>
    </div>
    <div class="card-body">
        {{ formset.management_form }}
        <div class="formset-container" data-formset-prefix="{{ formset.prefix }}">
            {% for form in formset %}
                <div class="card mb-3 formset-row" data-formset-index="{{ forloop.counter0 }}">
                    <div class="card-body">
                        {% if form.instance.pk %}{{ form.DELETE }}{% endif %}
                        {{ form.id }}
                        
                        <div class="row g-3">
                            <div class="col-md-4">
                                <label class="form-label">Nome</label>
                                {{ form.nome|add_class:"form-control" }}
                                {% if form.nome.errors %}
                                    <div class="text-danger small">{{ form.nome.errors.0 }}</div>
                                {% endif %}
                            </div>
                            
                            <div class="col-md-4">
                                <label class="form-label">Cargo</label>
                                {{ form.cargo|add_class:"form-control" }}
                            </div>
                            
                            <div class="col-md-4">
                                <label class="form-label">Departamento</label>
                                {{ form.departamento|add_class:"form-control" }}
                            </div>
                        </div>
                        
                        <div class="row g-3 mt-2">
                            <div class="col-md-3">
                                <label class="form-label">Telefone</label>
                                {{ form.telefone|add_class:"form-control phone-mask" }}
                            </div>
                            
                            <div class="col-md-3">
                                <label class="form-label">Celular</label>
                                {{ form.celular|add_class:"form-control phone-mask" }}
                            </div>
                            
                            <div class="col-md-4">
                                <label class="form-label">Email</label>
                                {{ form.email|add_class:"form-control" }}
                            </div>
                            
                            <div class="col-md-2">
                                <div class="form-check mt-4">
                                    {{ form.principal|add_class:"form-check-input" }}
                                    <label class="form-check-label">Contato Principal</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row g-3 mt-2">
                            <div class="col-12">
                                <label class="form-label">Observações</label>
                                {{ form.observacoes|add_class:"form-control"|attr:"rows:2" }}
                            </div>
                        </div>
                        
                        {% if not forloop.first %}
                            <button type="button" class="btn btn-sm btn-danger mt-2 remove-formset-row">
                                <i class="fas fa-trash me-1"></i> Remover
                            </button>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</div>
